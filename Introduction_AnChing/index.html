<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Data Representation</title>
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <style>
    body {
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      align-items: center;
      margin: 0;
      background-color: #f9f9f9;
      font-family: Arial, sans-serif;
    }

    .intro p {
      font-size: 1.5rem;
      font-weight: bold;
      line-height: 1.4;
      text-align: left; /* 向左排列 */
      padding: 0; /* 移除內邊距 */
      margin: 200px auto 50px; /* 添加上方空間，並保持區塊居中 */
      width: 100%; /* 設置寬度 */
      opacity: 0; /* 初始隱藏 */
      animation: fadeIn 1s ease forwards;
      animation-delay: var(--delay); /* 使用不同延遲時間 */
    }

    /* 動畫效果 */
    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(20px); /* 初始位置稍微下移 */
      }
      to {
        opacity: 1;
        transform: translateY(0); /* 回到原位 */
      }
    }

    /* 文字段落的容器 */
    .intro {
      display: flex;
      flex-direction: column;
      gap: 10px; /* 段落之間的距離 */
    }

    
    .number-visualization {
      display: flex;
      justify-content: center;
      align-items: center;
      background-color: #f2f0eb;
      padding: 20px 0;
      width: 100vw;
      margin: 0;
      gap: 10px;
    }

    .number-card {
      text-align: center;
      color: #333;
      flex: 0 4 auto;
      margin: 0 100px;
    }

    .number-card h2 {
      font-size: 4rem;
      margin: 0;
    }

    .number-card p {
      font-size: 1.2rem;
      margin: 5px 0 0;
    }

    h1 {
      text-align: center;
      margin: 200px auto 20px; /* 添加上方空間，並保持區塊居中 */
      margin-bottom: 20px;
    }

    #chart {
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .icon-grid {
    display: flex;
    justify-content: center;
    align-items: flex-start;
    gap: 20px;
    padding: 20px;
    background-color: #f2f2f2;
    width: 80%;
    margin: 20px 0;
  }

  .icon-card {
    text-align: center;
    background-color: white;
    border-radius: 8px;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    padding: 20px;
    width: 20%;
  }

  .icon-card img {
    width: 60px;
    height: 60px;
    margin-bottom: 10px;
  }

  .icon-card h2 {
    font-size: 1.2rem;
    margin: 10px 0;
  }

  .icon-card p {
    font-size: 0.9rem;
    color: #666;
  }  
  </style>
</head>
<body>
  <div class="intro">
    <p>
      This project illustrates how students<br>
      engage in problem-solving<br>
      with the support of GAI and browser tools<br>
      in a project-based statistics course exam.
    </p>
  </div>

  <div class="number-visualization">
    <div class="number-card">
      <h2>90</h2>
      <p>Students</p>
    </div>
    <div class="number-card">
      <h2>20,700</h2>
      <p>Entry Counts</p>
    </div>
    <div class="number-card">
      <h2>12,675</h2>
      <p>Minutes Screen Recording</p>
    </div>
  </div>

  <h1>Background of Students</h1>
  <div id="chart"></div>

  <h1>Screen Usage Behaviors in Exams</h1>
  <div id="chart"></div>

  <hr style="border: 1px solid #ccc; width: 80%; margin: 20px auto;">
  
  <div class="icon-grid">
    <div class="icon-card">
      <img src="icon/data-analysis.png" alt="Data Analysis Icon">
      <h2>Work.Analysis</h2>
      <p>
      When windows displaying RStudio or offline Excel files are observed, these will be interpreted as evidence of analysis in progress.
      </p>
    </div>
  
    <div class="icon-card">
      <img src="icon/exam.png" alt="Exam Icon">
      <h2>Work.Sheet</h2>
      <p>
        When displays show GDocument or PDF, it will be interpreted as evidence of exam-related reading and answering activities.
      </p>
    </div>
  
    <div class="icon-card">
      <img src="icon/website.png" alt="Browser Icon">
      <h2>Search.Browser</h2>
      <p>
        When a browser window is displayed, it will be interpreted as evidence of browsing for information.
    </div>
  
    <div class="icon-card">
      <img src="icon/ai-robot.png" alt="AI Robot Icon">
      <h2>Search.GAI</h2>
      <p>
        When displays show ChatGPT, Perplexity, Bard, or Claude, this will be interpreted as evidence of GAI usage.
      </p>
    </div>
  </div>

  <h1>Data Collecting</h1>
  <div id="gif-container">
    <img src="ComputerBasedTest_GIF/Analysis+Sheet.gif" alt="GIF 1" class="gif">
    <img src="ComputerBasedTest_GIF/GAI.gif" alt="GIF 2" class="gif">
    <img src="ComputerBasedTest_GIF/Xlsx+Sheet.gif" alt="GIF 3" class="gif">
    <img src="ComputerBasedTest_GIF/Analysis+Sheet+GAI+Browser.gif" alt="GIF 4" class="gif">
  </div>

  <script>
    d3.csv("112_Data_in_person_New.csv").then(data => {
      // Dimensions
      const width = 800;
      const height = 400;
      const margin = { top: 20, right: 20, bottom: 50, left: 20 };
      const gridWidth = (width - margin.left - margin.right) / 3 - 10;
      const gridHeight = height - margin.top - margin.bottom;
      const rows = 10;
      const cols = 9;
      const padding = 0.5;
      const cubeSize = Math.min(gridWidth / cols, gridHeight / rows) * 0.6;

      const svg = d3.select("#chart")
        .append("svg")
        .attr("width", width)
        .attr("height", height + 100)
        .append("g")
        .attr("transform", `translate(${margin.left}, ${margin.top})`);

      // Aggregate counts
      const genderCounts = d3.rollup(data, v => v.length, d => d.Male);
      const classCounts = d3.rollup(data, v => v.length, d => d.Class);
      const statExpriCounts = d3.rollup(data, v => v.length, d => d.Stat_expri);

      // Define colors
      const colors = {
        Male: "#2C3E54",
        Female: "#BFCFD5",
        Basic: "#D1B689",
        Intermediate: "#B05C25",
        Advanced: "#4E0F07",
        "No Experience": "#848758",
        "With Experience": "#3A341E"
      };

      // Function to create a grid with animation
      function createGrid(groupedData, groupColors, xOffset, order = null, delayFactor = 0) {
        const totalBlocks = rows * cols;
        const groups = Array.from(groupedData.entries());

        let blocks = [];

        if (order) {
          order.forEach(key => {
            const entry = groups.find(([groupKey]) => groupKey === key);
            if (entry) {
              const numBlocks = Math.round((entry[1] / data.length) * totalBlocks);
              blocks = [...blocks, ...Array(numBlocks).fill(key)];
            }
          });
        } else {
          groups.forEach(([key, count]) => {
            const numBlocks = Math.round((count / data.length) * totalBlocks);
            blocks = [...blocks, ...Array(numBlocks).fill(key)];
          });
        }

        blocks.forEach((group, index) => {
          const row = Math.floor(index / cols);
          const col = index % cols;

          svg.append("rect")
            .attr("x", xOffset + col * (cubeSize + padding))
            .attr("y", row * (cubeSize + padding))
            .attr("width", cubeSize - padding)
            .attr("height", cubeSize - padding)
            .attr("fill", groupColors[group])
            .attr("class", "cube")
            .attr("opacity", 0)
            .transition()
            .delay(index * 30 + delayFactor)
            .duration(500)
            .attr("opacity", 1);
        });
      }

      createGrid(genderCounts, colors, 0, null, 0);
      createGrid(classCounts, colors, gridWidth + 10, ["Basic", "Intermediate", "Advanced"], rows * cols * 30);
      createGrid(statExpriCounts, colors, 2 * (gridWidth + 10), ["No Experience", "With Experience"], rows * cols * 60);

      function addLegend(xOffset, labels, groupColors, title) {
        const legend = svg.append("g")
          .attr("transform", `translate(${xOffset}, ${gridHeight - 120})`);

        legend.append("text")
          .text(title)
          .attr("x", 0)
          .attr("y", -10)
          .style("font-size", "14px")
          .style("font-family", "Arial")
          .style("font-weight", "bold");

        labels.forEach((label, i) => {
          legend.append("rect")
            .attr("x", 0)
            .attr("y", i * 20)
            .attr("width", 12)
            .attr("height", 12)
            .attr("fill", groupColors[label]);

          legend.append("text")
            .attr("x", 20)
            .attr("y", i * 20 + 10)
            .text(label)
            .style("font-size", "12px")
            .style("font-family", "Arial");
        });
      }

      addLegend(0, ["Male", "Female"], colors, "Gender");
      addLegend(gridWidth + 10, ["Basic", "Intermediate", "Advanced"], colors, "Difficulty");
      addLegend(2 * (gridWidth + 10), ["No Experience", "With Experience"], colors, "Statistic Learning");
    });
  </script>

<style>
  #gif-container {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 20px;
    margin-bottom: 200px;
  }

  .gif {
    width: 300px;
    height: auto;
  }
</style>

</body>
</html>
